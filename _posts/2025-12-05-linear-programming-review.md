---
title: "第二三章：线性规划与单纯形法"
date: 2025-12-05 10:00:00 +0800
categories: [学习笔记, 最优化]
tags: [数学, 线性规划, 单纯形法, 期末复习]
math: true
---

本章整理了最优化理论第二、三章的核心内容，重点梳理了线性规划的标准型转化、基本可行解与极点的几何联系、单纯形法的计算流程以及处理人工变量的两种方法（大M法与两阶段法）。

## 1. 线性规划的基本性质

### 1.1 标准形式
线性规划 (LP) 的标准形式必须满足以下 4 个条件：
1. **目标函数**：极小化型 ($\min z = cx$)。
2. **约束条件**：均为等式约束 ($Ax = b$)。
3. **决策变量**：所有变量非负 ($x \ge 0$)。
4. **右端项**：约束方程右端常数非负 ($b \ge 0$)。

数学表达为：
$$
\begin{aligned}
\min \quad & z = cx \\
\text{s.t.} \quad & Ax = b \\
& x \ge 0
\end{aligned}
$$
其中 $A$ 是 $m \times n$ 矩阵 ($m < n$)，$\text{rank}(A) = m$。

> **化标准形的方法**：
> * **目标函数**：若为 $\max z$，转化为 $\min -z$。
> * **不等式约束**：
>     * $\sum a_{ij}x_j \le b_i \Rightarrow$ 加入**松弛变量** $x_s \ge 0$，变为 $\sum a_{ij}x_j + x_s = b_i$。
>     * $\sum a_{ij}x_j \ge b_i \Rightarrow$ 减去**剩余变量** $x_e \ge 0$，变为 $\sum a_{ij}x_j - x_e = b_i$。
> * **自由变量**：若 $x_j$ 无符号限制，令 $x_j = x_j' - x_j''$，其中 $x_j', x_j'' \ge 0$。

### 1.2 基本概念辨析
* **可行域**：满足所有约束条件的点的集合 $K = \{x \mid Ax=b, x \ge 0\}$。线性规划的可行域是凸集（凸多面体）。
* **基 (Basis)**：$A$ 中 $m$ 个线性无关的列向量构成的子矩阵 $B$。对应的变量称为**基变量** ($x_B$)，其余为**非基变量** ($x_N$)。
* **基本解**：令非基变量 $x_N = 0$，解方程 $Bx_B = b$ 得到的解 $x = (x_B, 0)^T$。
* **基本可行解 (BFS)**：满足非负性 ($x_B \ge 0$) 的基本解。
    * **非退化**：基变量全部严格大于 0 ($x_B > 0$)。
    * **退化**：基变量中至少有一个为 0。

### 1.3 核心定理 (几何与代数的联系)

这一部分建立了代数解（BFS）与几何极点之间的桥梁，是单纯形法的理论基石。

> **定理 2.2.4 (基本可行解的存在性)**
> 如果 $Ax=b, x \ge 0$ 有可行解，则一定存在基本可行解。其中 $A$ 是 $m \times n$ 矩阵，$A$ 的秩为 $m$。
>
> *这意味着只要问题有解，我们就一定能在顶点（极点）处找到解。*

> **定理 2.2 (BFS 与极点的等价性)**
> $x$ 是约束条件 $Ax=b, x \ge 0$ 的基本可行解 $\iff$ $x$ 是可行域 $K$ 的极点。

> **定理 2.2.2 (最优解的性质)**
> 设线性规划的可行域非空，则有下列结论：
> 1. 线性规划存在有限最优解的充要条件是所有 $cd^{(j)}$ 为非负数。其中 $d^{(j)}$ 是可行域的极方向。
> 2. 若线性规划存在有限最优解，则目标函数的最优值可在某个极点上达到。

这意味着单纯形法只需要在多面体的**顶点**（即基本可行解）之间搜索，而不需要遍历整个可行域。

---

## 2. 单纯形法 (Simplex Method)

单纯形法的核心思想是在可行域（凸多面体）的顶点（基本可行解）之间进行迭代：每次移动到一个相邻且目标函数值更优的顶点，直到找到最优解。

### 2.1 基本原理

设当前的基本可行解为 $x^{(0)}$，对应的基为 $B$，目标函数值为 $f_0 = c_B B^{-1} b$。
若我们要引入一个非基变量 $x_k$（使其从 0 变为正数），新的目标函数值 $f$ 与原函数值 $f_0$ 的关系推导如下：

1.  **分解约束方程**：
    将 $Ax=b$ 分解为基变量和非基变量部分：
    $$B x_B + N x_N = b \implies x_B = B^{-1}b - B^{-1}N x_N$$

2.  **代入目标函数**：
    $$
    \begin{aligned}
    f &= c x = c_B x_B + c_N x_N \\
    &= c_B (B^{-1}b - B^{-1}N x_N) + c_N x_N \quad (\text{代入 } x_B) \\
    &= c_B B^{-1}b - (c_B B^{-1} N - c_N) x_N
    \end{aligned}
    $$

3.  **引入检验数**：
    * 第一项 $c_B B^{-1}b$ 正是当前的目标函数值 $f_0$。
    * 第二项系数中，定义 $z = c_B B^{-1} N$。对于特定的非基变量 $x_k$，其对应的系数为 $z_k - c_k$。
    * 记 **检验数 (Reduced Cost)** 为 $\sigma_k = z_k - c_k$。

4.  **得出结论公式**：
    $$f = f_0 - \sum_{j \in R} (z_j - c_j)x_j$$
    假设只改变一个非基变量 $x_k$，则有：
    $$f = f_0 - (z_k - c_k)x_k = f_0 - \sigma_k x_k$$

其中 $z_k = c_B B^{-1} p_k$。令检验数 (Reduced Cost) 为 $\sigma_k = z_k - c_k$。

* **对于最小化问题 ($\min$)**：
    我们希望 $f < f_0$，即希望减项 $(z_k - c_k)x_k$ 为正。因为 $x_k > 0$，所以必须要求检验数 **$\sigma_k = z_k - c_k > 0$**。
    * **结论**：只要存在正的检验数，目标函数值就有下降空间。为了下降得最快，通常选择 $\sigma_k$ 最大的那个变量入基。
    * **最优性条件**：当所有 $\sigma_j \le 0$ 时，无法再通过增加 $x_j$ 来减小 $f$，此时达到最优。

### 2.2 单纯形法详细步骤 (以 Min 问题为例)

根据定理 3.1.2 及计算流程，单纯形法包含以下循环步骤：

#### 第一步：最优性检验
计算所有非基变量的检验数 $\sigma_j = z_j - c_j = c_B B^{-1} p_j - c_j$。
* 若所有 $\sigma_j \le 0$，则当前基可行解即为**最优解**，算法结束。
* 若存在 $\sigma_j > 0$，则解未最优，选择 $\sigma_k = \max \{ \sigma_j \mid \sigma_j > 0 \}$ 对应的变量 $x_k$ 作为**进基变量**。

#### 第二步：可行性检验（确定离基变量）
计算主列向量 $y_k = B^{-1} p_k$。
* 若 $y_k \le 0$（即所有元素非正），说明 $x_k$ 可以无限增大而保持可行，目标函数趋于 $-\infty$，问题**无界**，算法结束。
* 否则，利用**最小比值法则**确定离基变量 $x_{B_r}$：
    $$
    \theta = \frac{\bar{b}_r}{y_{rk}} = \min \left\{ \frac{\bar{b}_i}{y_{ik}} \mid y_{ik} > 0 \right\}
    $$
    这一步是为了保证新的基变量值 $\bar{b}_{new}$ 仍然非负（即 $x \ge 0$）。

#### 第三步：旋转变换 (Pivot)
以 $y_{rk}$ 为主元进行行变换（高斯消元），将 $p_k$ 列化为单位向量（第 $r$ 行是 1，其余是 0）。
* **更新**：用 $p_k$ 替换基中的 $p_{B_r}$，得到新的基矩阵 $B$ 和新的基本可行解，返回第一步。

### 2.3 极大化问题 (Max) 的区别

对于 $\max z = cx$ 问题，逻辑完全对称，但判据符号相反。

| 比较项目 | 极小化问题 ($\min$) | 极大化问题 ($\max$) |
| :--- | :--- | :--- |
| **改进方向** | 寻找 $f$ 减小的方向 | 寻找 $f$ 增大的方向 |
| **入基准则** | 找**正**的检验数 ($\sigma_k > 0$) | 找**负**的检验数 ($\sigma_k < 0$) |
| **出基准则** | **最小比值法则** (完全相同) <br> $\theta = \min \\{ \frac{\bar{b}_i}{y_{ik}} \mid y_{ik} > 0 \\}$ | **最小比值法则** (完全相同) <br> $\theta = \min \\{ \frac{\bar{b}_i}{y_{ik}} \mid y_{ik} > 0 \\}$ |
| **最优性条件** | 所有 $\sigma_j \le 0$ | 所有 $\sigma_j \ge 0$ |
| **选择策略** | 选 $\max \sigma_j > 0$ | 选 $\min \sigma_j < 0$ (绝对值最大的负数) |

> **注意**：离基变量的规则（最小比值法则）**不变**，因为它只与可行域 ($Ax=b, x\ge 0$) 有关，与目标函数是求大还是求小无关。

### 2.4 初始基构造：大M法与两阶段法
当约束条件包含 $\ge$ 或 $=$ 时，无法直接找到初始单位基，需引入**人工变量** $x_a$。

#### 1. 大M法 (Big-M Method)
* **原理**：在目标函数中对人工变量施加惩罚 $M$（充分大的正数）。
  $$
  \min z = cx + M \sum x_{a_i}
  $$
* **判据**：若最优表中仍有人工变量 $x_{a_i} > 0$，则原问题无解。
* **计算技巧**：检验数 $\sigma_j$ 包含 $M$ 项（如 $3M - 1$）。比较大小时，先比较 $M$ 的系数，若相同再比较常数项。

#### 2. 两阶段法 (Two-Phase Method)
* **第一阶段**：
    * 目标：$\min w = \sum x_{a_i}$
    * 若 $w_{\min} > 0$，原问题无解。
    * 若 $w_{\min} = 0$，得到原问题的初始基可行解，进入第二阶段。
* **第二阶段**：
    * 去掉人工变量列，恢复原目标函数。
    * 从第一阶段的终表开始继续单纯形迭代。

---

## 3. 重点习题详解

### 习题 1：基本可行解的求解 (例 5.1)
**题目**：考虑由不等式定义的集合：
$$
\begin{cases} x_1 + 2x_2 \le 8 \\ x_2 \le 2 \\ x_1, x_2 \ge 0 \end{cases}
$$
求该集合的所有极点（即基本可行解）。

**解**：
1. **化为标准形式**：引入松弛变量 $x_3, x_4 \ge 0$，方程组变为：
   $$
   \begin{cases} x_1 + 2x_2 + x_3 = 8 \\ x_2 + x_4 = 2 \end{cases}
   $$
   系数矩阵 $A = (p_1, p_2, p_3, p_4) = \begin{pmatrix} 1 & 2 & 1 & 0 \\ 0 & 1 & 0 & 1 \end{pmatrix}$。

2. **寻找基矩阵并求解**：从 4 列中选 2 列构成基 $B$（共 $\binom{4}{2}=6$ 种，需排除线性相关）。
   * **基 $B_1 = (p_1, p_2)$**：解得 $x = (4, 2, 0, 0)^T$。所有分量非负，是**基本可行解**。
   * **基 $B_2 = (p_1, p_4)$**：解得 $x = (8, 0, 0, 2)^T$。是**基本可行解**。
   * **基 $B_3 = (p_2, p_3)$**：解得 $x = (0, 2, 4, 0)^T$。是**基本可行解**。
   * **基 $B_4 = (p_2, p_4)$**：解得 $x = (0, 4, 0, -2)^T$。因 $x_4 < 0$，**不是**基本可行解。
   * **基 $B_5 = (p_3, p_4)$**：对应原点 $(0, 0, 8, 2)^T$，是**基本可行解**。

**结论**：该集合有 4 个极点，对应的坐标 $(x_1, x_2)$ 分别为 $(4, 2), (8, 0), (0, 2), (0, 0)$。

<br>

### 习题 2：单纯形法标准计算 (例 5.2)
**题目**：用单纯形法求解：
$$
\min z = x_1 - 2x_2 + x_3
$$
$$
\text{s.t.} \begin{cases} x_1 + x_2 - 2x_3 + x_4 = 10 \\ 2x_1 - x_2 + 4x_3 + x_5 = 8 \\ -x_1 + 2x_2 - 4x_3 + x_6 = 4 \end{cases}, \quad x_j \ge 0
$$

**解**：
1. **初始表**：以 $x_4, x_5, x_6$ 为基。计算检验数，发现 $\sigma_2 = 2$ 最大（正数），选 $x_2$ 入基。
   * 最小比值：$\min \{10/1, -, 4/2\} = 2$，选 $x_6$ 离基。
2. **第一次迭代**：对第 3 行的主元 2 进行旋转。更新后 $\sigma_3 = 3 > 0$，选 $x_3$ 入基。
   * 最小比值：$x_5$ 对应行比值最小，选 $x_5$ 离基。
3. **第二次迭代**：旋转后，所有 $\sigma_j \le 0$。

**结论**：得到最优解 $x^* = (0, 12, 5, 8, 0, 0)^T$，最优值 $z_{\min} = -19$。

<br>

### 习题 3：无界解的判定 (例 5.3)
**题目**：求解 $\min z = -3x_1 + x_2$，约束略。

**解**：
单纯形表迭代中，若发现非基变量 $x_2$ 的检验数 $\sigma_2 = 2 > 0$，可以继续优化。但查看该列对应的系数向量 $y_2 = (-1, -1)^T$，所有元素均非正 ($y_{i2} \le 0$)。

**结论**：这意味着 $x_2$ 可以无限增加而不破坏可行性，同时目标函数值持续减小（趋向 $-\infty$）。故该线性规划问题**无界**（无有限最优解）。
