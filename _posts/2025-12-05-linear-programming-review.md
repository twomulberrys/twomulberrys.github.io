---
title: 第二三章：线性规划与单纯形法
date: 2025-12-05 10:00:00 +0800
categories: [学习笔记, 最优化]
tags: [数学, 线性规划, 单纯形法, 期末复习]
math: true
---

整理了最优化理论第二、三章的核心内容，重点梳理了线性规划的标准型转化、基本可行解与极点的几何联系、单纯形法的计算流程以及处理人工变量的两种方法（大M法与两阶段法）。

## 1. 线性规划的基本性质

### 1.1 标准形式
线性规划 (LP) 的标准形式必须满足以下 4 个条件：
1.  **目标函数**：极小化型 ($\min z = cx$)。
2.  **约束条件**：均为等式约束 ($Ax = b$)。
3.  **决策变量**：所有变量非负 ($x \ge 0$)。
4.  **右端项**：约束方程右端常数非负 ($b \ge 0$)。

数学表达为：
$$
\begin{aligned}
\min \quad & z = cx \\
\text{s.t.} \quad & Ax = b \\
& x \ge 0
\end{aligned}
$$
其中 $A$ 是 $m \times n$ 矩阵 ($m < n$)，$\text{rank}(A) = m$。

> **化标准形的方法**：
> * **目标函数**：若为 $\max z$，转化为 $\min -z$。
> * **不等式约束**：
>     * $\sum a_{ij}x_j \le b_i \Rightarrow$ 加入**松弛变量** $x_s \ge 0$，变为 $\sum a_{ij}x_j + x_s = b_i$。
>     * $\sum a_{ij}x_j \ge b_i \Rightarrow$ 减去**剩余变量** $x_e \ge 0$，变为 $\sum a_{ij}x_j - x_e = b_i$。
> * **自由变量**：若 $x_j$ 无符号限制，令 $x_j = x_j' - x_j''$，其中 $x_j', x_j'' \ge 0$。

### 1.2 基本概念辨析
* **可行域**：满足所有约束条件的点的集合 $K = \{x \mid Ax=b, x \ge 0\}$。线性规划的可行域是凸集（凸多面体）。
* **基 (Basis)**：$A$ 中 $m$ 个线性无关的列向量构成的子矩阵 $B$。对应的变量称为**基变量** ($x_B$)，其余为**非基变量** ($x_N$)。
* **基本解**：令非基变量 $x_N = 0$，解方程 $Bx_B = b$ 得到的解 $x = (x_B, 0)^T$。
* **基本可行解 (BFS)**：满足非负性 ($x_B \ge 0$) 的基本解。
    * **非退化**：基变量全部严格大于 0 ($x_B > 0$)。
    * **退化**：基变量中至少有一个为 0。

### 1.3 核心定理 (几何与代数的联系)

> **定理 2.2 (BFS 与极点的等价性)**
> $x$ 是约束条件 $Ax=b, x \ge 0$ 的基本可行解 $\iff$ $x$ 是可行域 $K$ 的极点。

> **定理 2.1 (最优解与极点)**
> 若线性规划问题存在有限最优解，则目标函数的最优值一定可在可行域的某个极点上达到。

这意味着单纯形法只需要在多面体的**顶点**（即基本可行解）之间搜索，而不需要遍历整个可行域。

---

## 2. 单纯形方法 (Simplex Method)

单纯形法的本质是在凸多面体的顶点之间移动，使目标函数值不断下降。

### 2.1 核心判据 (以 min 问题为例)
设当前基为 $B$，单纯形乘子 $w = c_B B^{-1}$。

1.  **检验数 (Reduced Cost)**：对于非基变量 $x_j$，其检验数定义为：
    $$\sigma_j = z_j - c_j = w p_j - c_j = c_B B^{-1} p_j - c_j$$
    *(注：部分教材使用 $\sigma_j = c_j - z_j$，符号相反，需注意判别标准)*

2.  **最优性判别**：
    * 若所有非基变量的 $\sigma_j \le 0$，则当前解为最优解。
    * 若存在 $\sigma_k > 0$，则可以通过让 $x_k$ 入基来减小目标函数值。

3.  **迭代步骤**：
    * **入基变量**：选择 $\sigma_k = \max \{ \sigma_j \mid \sigma_j > 0 \}$ 对应的 $x_k$ 进基。
    * **离基变量 (最小比值法则)**：计算主列 $y_k = B^{-1} p_k$。若 $y_k \le 0$，则问题无界。否则，选择：
        $$\theta = \frac{\bar{b}_r}{y_{rk}} = \min \left\{ \frac{\bar{b}_i}{y_{ik}} \mid y_{ik} > 0 \right\}$$
        则基变量 $x_{B_r}$ 离基。
    * **旋转运算**：通过行变换将主元变为 1，该列其他元素变为 0，更新单纯形表。

### 2.2 初始基构造：大M法与两阶段法
当约束条件包含 $\ge$ 或 $=$ 时，无法直接找到初始单位基，需引入**人工变量** $x_a$。

#### 1. 大M法 (Big-M Method)
* **原理**：在目标函数中对人工变量施加惩罚 $M$（充分大的正数）。
    $$\min z = cx + M \sum x_{a_i}$$
* **判据**：若最优表中仍有人工变量 $x_{a_i} > 0$，则原问题无解。
* **计算技巧**：检验数 $\sigma_j$ 包含 $M$ 项（如 $3M - 1$）。比较大小时，先比较 $M$ 的系数，若相同再比较常数项。

#### 2. 两阶段法 (Two-Phase Method)
* **第一阶段**：
    * 目标：$\min w = \sum x_{a_i}$
    * 若 $w_{\min} > 0$，原问题无解。
    * 若 $w_{\min} = 0$，得到原问题的初始基可行解，进入第二阶段。
* **第二阶段**：
    * 去掉人工变量列，恢复原目标函数。
    * 从第一阶段的终表开始继续单纯形迭代。

---

## 3. 重点习题详解

### 习题 1：基本可行解的求解 (例 5.1)
**题目**：考虑由不等式定义的集合：
$$\begin{cases} x_1 + 2x_2 \le 8 \\ x_2 \le 2 \\ x_1, x_2 \ge 0 \end{cases}$$
求该集合的所有极点（即基本可行解）。

**解**：
1.  **化为标准形式**：引入松弛变量 $x_3, x_4 \ge 0$，方程组变为：
    $$\begin{cases} x_1 + 2x_2 + x_3 = 8 \\ x_2 + x_4 = 2 \end{cases}$$
    系数矩阵 $A = (p_1, p_2, p_3, p_4) = \begin{pmatrix} 1 & 2 & 1 & 0 \\ 0 & 1 & 0 & 1 \end{pmatrix}$。

2.  **寻找基矩阵并求解**：从 4 列中选 2 列构成基 $B$（共 $\binom{4}{2}=6$ 种，需排除线性相关）。
    * **基 $B_1 = (p_1, p_2)$**：解得 $x = (4, 2, 0, 0)^T$。所有分量非负，是**基本可行解**。
    * **基 $B_2 = (p_1, p_4)$**：解得 $x = (8, 0, 0, 2)^T$。是**基本可行解**。
    * **基 $B_3 = (p_2, p_3)$**：解得 $x = (0, 2, 4, 0)^T$。是**基本可行解**。
    * **基 $B_4 = (p_2, p_4)$**：解得 $x = (0, 4, 0, -2)^T$。因 $x_4 < 0$，**不是**基本可行解。
    * **基 $B_5 = (p_3, p_4)$**：对应原点 $(0, 0, 8, 2)^T$，是**基本可行解**。

**结论**：该集合有 4 个极点，对应的坐标 $(x_1, x_2)$ 分别为 $(4, 2), (8, 0), (0, 2), (0, 0)$。

<br>

### 习题 2：单纯形法标准计算 (例 5.2)
**题目**：用单纯形法求解：
$$\min z = x_1 - 2x_2 + x_3$$
$$\text{s.t.} \begin{cases} x_1 + x_2 - 2x_3 + x_4 = 10 \\ 2x_1 - x_2 + 4x_3 + x_5 = 8 \\ -x_1 + 2x_2 - 4x_3 + x_6 = 4 \end{cases}, \quad x_j \ge 0$$

**解**：
1.  **初始表**：以 $x_4, x_5, x_6$ 为基。计算检验数，发现 $\sigma_2 = 2$ 最大（正数），选 $x_2$ 入基。
    * 最小比值：$\min \{10/1, -, 4/2\} = 2$，选 $x_6$ 离基。
2.  **第一次迭代**：对第 3 行的主元 2 进行旋转。更新后 $\sigma_3 = 3 > 0$，选 $x_3$ 入基。
    * 最小比值：$x_5$ 对应行比值最小，选 $x_5$ 离基。
3.  **第二次迭代**：旋转后，所有 $\sigma_j \le 0$。

**结论**：得到最优解 $x^* = (0, 12, 5, 8, 0, 0)^T$，最优值 $z_{\min} = -19$。

<br>

### 习题 3：无界解的判定 (例 5.3)
**题目**：求解 $\min z = -3x_1 + x_2$，约束略。

**解**：
单纯形表迭代中，若发现非基变量 $x_2$ 的检验数 $\sigma_2 = 2 > 0$，可以继续优化。但查看该列对应的系数向量 $y_2 = (-1, -1)^T$，所有元素均非正 ($y_{i2} \le 0$)。

**结论**：这意味着 $x_2$ 可以无限增加而不破坏可行性，同时目标函数值持续减小（趋向 $-\infty$）。故该线性规划问题**无界**（无有限最优解）。
