---
title: 第八、九章：算法基础与一维搜索
date: 2025-12-07 10:00:00 +0800
categories: [学习笔记, 最优化]
tags: [数学, 数值算法, 一维搜索, 收敛性]
math: true
mermaid: true
---

从本章开始，最优化理论从“解的性质”（KKT 条件）转向“如何通过计算求解”（算法）。第八章建立了算法收敛性的理论框架，第九章则介绍了最基础的子问题求解方法——一维搜索（Line Search）。

## 1. 算法基础理论 (第八章)

### 1.1 算法与映射
在最优化中，算法被视为一种**点到集**的映射。

> **定义 8.1.1 (算法映射)**
> 设 $X$ 是空间，算法是定义在 $X$ 上的点到集映射 $A: X \to \mathcal{P}(X)$。
> 给定迭代点 $x^{(k)}$，下一点 $x^{(k+1)}$ 选自集合 $A(x^{(k)})$。

* **解集合 ($\Omega$)**：我们希望算法收敛到的目标点集（例如满足 $\nabla f(x)=0$ 的点集）。
* **下降函数 ($\alpha(x)$)**：类似于李雅普诺夫函数，用于监测算法进程。若 $x \notin \Omega$，则 $\alpha(y) < \alpha(x)$ 对所有 $y \in A(x)$ 成立。通常取 $\alpha(x) = f(x)$ 或 $\alpha(x) = \|\nabla f(x)\|$。

### 1.2 算法的闭性 (Closedness)
闭性是点到点映射“连续性”在点到集映射中的推广，是证明算法收敛的关键。

> **定义 8.1.3 (闭映射)**
> 设 $x^{(k)} \to x$，且 $y^{(k)} \in A(x^{(k)})$，$y^{(k)} \to y$。若能推出 $y \in A(x)$，则称映射 $A$ 在点 $x$ 处是闭的。

### 1.3 全局收敛定理 (Zangwill 定理)
这是分析迭代算法收敛性的“核武器”。

> **定理 8.2.1 (收敛定理)**
> 设算法 $A$ 产生序列 $\{x^{(k)}\}$，解集合为 $\Omega$。若满足以下三个条件：
> 1.  序列 $\{x^{(k)}\}$ 含于紧集（有界）；
> 2.  存在连续的下降函数 $\alpha(x)$；
> 3.  映射 $A$ 在解集合的补集（非解区域）上是**闭的**。
>
> 则序列的任一收敛子序列的极限属于 $\Omega$。

### 1.4 收敛速率与实例
评价算法快慢的标准。设 $x^{(k)} \to x^*$，定义误差 $e_k = \|x^{(k)} - x^*\|$。
若 $\lim_{k\to\infty} \frac{e_{k+1}}{e_k^p} = \beta < \infty$：

* **$p=1, 0 < \beta < 1$**：线性收敛 (Linear)。
* **$p=1, \beta=0$**：超线性收敛 (Superlinear)。
* **$p=2$**：二阶收敛/平方收敛 (Quadratic)，速度最快。

#### **例题讲解：收敛速率的判定**
(来源：PDF P252 例 8.2.1, 8.2.2)

**例 1：线性收敛**
考虑序列 $\{a^k\}$，其中 $0 < a < 1$。
$$
\lim_{k\to\infty} \frac{e_{k+1}}{e_k} = \lim_{k\to\infty} \frac{a^{k+1}}{a^k} = a
$$
因 $0 < a < 1$，故为**线性收敛**。

**例 2：二阶收敛**
考虑序列 $\{a^{2^k}\}$，其中 $0 < |a| < 1$。
$$
\lim_{k\to\infty} \frac{e_{k+1}}{e_k^2} = \lim_{k\to\infty} \frac{a^{2^{k+1}}}{(a^{2^k})^2} = \lim_{k\to\infty} \frac{a^{2 \cdot 2^k}}{a^{2 \cdot 2^k}} = 1
$$
此处 $p=2, \beta=1$，故为**二阶收敛**。这解释了为什么牛顿法（二阶收敛）比梯度下降法（线性收敛）快得多。

---

## 2. 一维搜索 (Line Search) (第九章)

一维搜索是多维优化算法（如梯度下降、共轭梯度）的**基本子程序**。
目标：求解 $\min_{\lambda} \varphi(\lambda) = f(x_k + \lambda d_k)$。

### 2.1 试探法 (无导数)
适用于函数表达式复杂或不可微，但单峰（Unimodal）的情况。

#### (1) 0.618 法 (黄金分割法)
利用黄金分割比 $\tau \approx 0.618$ 来缩短包含极小点的区间 $[a, b]$。

* **缩短率**：每次迭代区间长度缩小为原来的 0.618 倍。
* **试探点公式**：
    $$
    \begin{cases}
    \lambda_k = a_k + 0.382(b_k - a_k) \\
    \mu_k = a_k + 0.618(b_k - a_k)
    \end{cases}
    $$
* **性质**：每次迭代只需计算**一个**新的函数值（利用对称性复用旧点）。

#### (2) Fibonacci 法
0.618 法的离散形式，利用 Fibonacci 数列 $\{F_k\}$ 构造试探点。
* **特点**：在给定计算次数 $n$ 的前提下，它是缩短区间效率最高的方法。
* **极限**：当 $n \to \infty$ 时，Fibonacci 法退化为 0.618 法。

### 2.2 函数逼近法 (使用导数)
利用插值多项式逼近原函数，收敛速度通常快于试探法。

#### (1) 牛顿法 (Newton's Method)
利用二阶泰勒展开，用抛物线的极小点近似函数的极小点。
* **迭代公式**：
    $$x^{(k+1)} = x^{(k)} - \frac{f'(x^{(k)})}{f''(x^{(k)})}$$
* **收敛性**：二阶收敛 ($p=2$)。
* **缺点**：需要计算二阶导数 $f''$，且要求 $f''(x) \neq 0$。

#### (2) 割线法 (Secant Method)
用差分代替牛顿法中的二阶导数。
* **迭代公式**：
    $$x^{(k+1)} = x^{(k)} - \frac{x^{(k)} - x^{(k-1)}}{f'(x^{(k)}) - f'(x^{(k-1)})} f'(x^{(k)})$$
* **收敛性**：收敛级约为 $1.618$（黄金分割比），介于线性与二阶之间。

#### (3) 插值法 (抛物线/三次)
* **抛物线法**：利用三点的函数值构造二次多项式。
* **三次插值**：利用两点的函数值和导数值构造三次多项式，收敛级为 2。

---

## 3. 重点习题详解

### 习题 1：收敛级的判定 (PDF P253 习题 3)
**题目**：求序列 $\gamma_k = (\frac{1}{k})^k$ 的收敛级。

**解**：
设极限为 0。考查比值：
$$
\frac{|\gamma_{k+1}|}{|\gamma_k|^p} = \frac{(k+1)^{-(k+1)}}{k^{-kp}} = \frac{k^{kp}}{(k+1)^{k+1}}
$$
若取 $p=1$（线性），极限为 0，说明比线性快。
实际上，对于任意给定的 $p \ge 1$，当 $k$ 充分大时，该序列收敛速度都极快，属于**超线性收敛**。

### 习题 2：0.618 法计算 (PDF P259 例 9.2.1)
**题目**：$\min f(x) = 2x^2 - x - 1$，初始区间 $[-1, 1]$，精度 $L \le 0.16$。

**解**：
1.  **初始化**：$a_1=-1, b_1=1$，长度 $2$。
    $\lambda_1 = -1 + 0.382(2) = -0.236$，$\mu_1 = -1 + 0.618(2) = 0.236$。
    计算得 $f(\lambda_1) \approx -0.653$，$f(\mu_1) \approx -1.125$。
2.  **迭代 1**：因为 $f(\lambda_1) > f(\mu_1)$，极小点在右侧区间 $[\lambda_1, b_1]$。
    新区间 $[a_2, b_2] = [-0.236, 1]$。
    保留旧点 $\mu_1$ 变为新区间左试探点 $\lambda_2 = 0.236$（无需重算函数值）。
    计算新 $\mu_2 = -0.236 + 0.618(1.236) \approx 0.528$。
    比较 $f(\lambda_2)$ 与 $f(\mu_2)$...
3.  **终止**：经过 6 次迭代，区间长度缩短为 $2 \times (0.618)^5 \approx 0.18$（接近要求）。
    最终极小点落在 $[0.168, 0.279]$ 内（真解为 $0.25$）。

### 习题 3：牛顿法求极小 (PDF P280 习题 2)
**题目**：用牛顿法求 $\min f(x) = 3x^4 - 4x^3 - 12x^2$，取初点 $x^{(0)} = -1.2$。

**解**：
1.  **求导**：
    $f'(x) = 12x^3 - 12x^2 - 24x$
    $f''(x) = 36x^2 - 24x - 24$
2.  **第一次迭代**：
    代入 $x^{(0)} = -1.2$：
    $f'(-1.2) = 12(-1.728) - 12(1.44) - 24(-1.2) = -9.216$
    $f''(-1.2) = 36(1.44) - 24(-1.2) - 24 = 56.64$
    $$x^{(1)} = -1.2 - \frac{-9.216}{56.64} \approx -1.2 + 0.1627 = -1.0373$$
3.  **分析**：
    函数的驻点满足 $12x(x^2 - x - 2) = 0 \implies x \in \{0, 2, -1\}$。
    检查二阶导：$f''(-1) = 36 + 24 - 24 = 36 > 0$，故 $-1$ 是极小点。
    初始点 $-1.2$ 靠近 $-1$，因此牛顿法将迅速收敛。

### 习题 4：割线法迭代 (PDF P280 习题 2)
**题目**：同上函数，用割线法，初点 $x^{(1)}=-0.8, x^{(2)}=-1.2$。

**解**：
迭代公式：$x^{(k+1)} = x^{(k)} - \frac{x^{(k)} - x^{(k-1)}}{f'(x^{(k)}) - f'(x^{(k-1)})} f'(x^{(k)})$
1.  **计算导数值**：
    $f'(-1.2) = -9.216$
    $f'(-0.8) = 12(-0.512) - 12(0.64) - 24(-0.8) = 5.376$
2.  **代入公式**：
    $$
    x^{(3)} = -1.2 - \frac{-1.2 - (-0.8)}{-9.216 - 5.376} \times (-9.216)
    $$
    $$
    x^{(3)} = -1.2 - \frac{-0.4}{-14.592} \times (-9.216)
    $$
    $$
    x^{(3)} = -1.2 - (0.0274) \times (-9.216) \approx -1.2 + 0.252 = -0.948
    $$
    **结论**：经过一次迭代，$x^{(3)} = -0.948$ 已经非常接近真解 $-1$。
