---
title: 3. 聚类 (Clustering)
date: 2025-12-08 21:00:00 +0800
categories: [学习笔记, 机器学习]
tags: [AI, 无监督学习, 聚类, 评价指标, 距离度量]
math: true
mermaid: true
---

如果说**特征降维**是“将书读薄”，那么**聚类** (Clustering) 就是“物以类聚，人以群分”的数学实践。它在没有标签指导的情况下，主动发现数据内在的结构与模式。

## 1. 任务定义：什么是聚类？

聚类的核心任务是：

> 将数据集中的样本，根据它们之间的**相似度**，自动划分为若干个互不相交的**簇** (Cluster)。

每个簇内部的样本应该**尽可能相似**（高内聚性），不同簇之间的样本应该**尽可能不同**（高分离性）。

### 1.1 形式化描述
- **输入**：样本集 \( D = \{x_1, x_2, \ldots, x_m\} \)（无标签）。
- **输出**：簇划分 \( C = \{C_1, C_2, \ldots, C_k\} \)，满足：
  - \( \bigcup_{i=1}^{k} C_i = D \)（覆盖所有样本）
  - \( C_i \cap C_j = \varnothing \)（簇间互斥）
- **簇标记**：为每个样本 \( x_j \) 分配一个簇编号 \( \lambda_j \)。

### 1.2 主要用途
1.  **探索性数据分析**：发现数据的自然分组结构（如客户细分、用户画像）。
2.  **数据预处理**：作为分类任务的前驱步骤，为无标签数据生成“伪标签”，从而训练有监督模型。

---

## 2. 基础：如何衡量“相似度”？

聚类的基础是**距离计算**，而计算距离前，必须清楚数据的属性类型。

| 属性类型 | 定义与例子 | 处理方法 |
| :--- | :--- | :--- |
| **连续属性** | 取值无穷（身高、温度） | 直接用欧氏距离、曼哈顿距离等数学公式计算 |
| **离散有序属性** | 取值有限且有顺序（衣服尺码S/M/L） | 可映射为数值（1, 2, 3），按连续属性处理 |
| **离散无序属性** | 取值有限且无顺序（交通工具、颜色） | 不能直接减，需用**VDM** (Value Difference Metric) 等方法处理 |

基于此，我们可以定义一系列衡量簇内、簇间关系的距离指标：
- **簇内平均距离**：\( avg(C) = \frac{2}{|C|(|C|-1)} \sum_{1 \le i < j \le |C|} dist(x_i, x_j) \)
- **簇内最远距离**：\( diam(C) = \max_{1 \le i < j \le |C|} dist(x_i, x_j) \)
- **簇间最近样本距离**：\( d_{\min}(C_i, C_j) = \min_{x \in C_i, y \in C_j} dist(x, y) \)
- **簇间中心点距离**：\( d_{\text{cen}}(C_i, C_j) = dist(\mu_i, \mu_j) \)

---

## 3. 如何评价聚类结果的好坏？

因为没有标签，聚类不像分类那样有“准确率”这一直观指标。其评价标准主要分为两类：

### 3.1 外部指标 (External Index)
> **需要“参考答案”（真实划分或另一套划分）**

通过比较聚类结果 \( C \) 与参考划分 \( C^* \) 的一致性来评价。
- **定义四个基础量**：
  - \( a \) (SS): 在 \( C \) 和 \( C^* \) 中都被分在同一簇的样本对数。
  - \( b \) (SD): 在 \( C \) 中同簇，但在 \( C^* \) 中不同簇。
  - \( c \) (DS): 在 \( C \) 中不同簇，但在 \( C^* \) 中同簇。
  - \( d \) (DD): 在 \( C \) 和 \( C^* \) 中都被分在不同簇的样本对数。

- **常用指标**（取值范围 [0, 1]，越大越好）：
  - **JC指数** (Jaccard Coefficient):
    \[ JC = \frac{a}{a+b+c} \]
  - **FMI指数** (Fowlkes-Mallows Index):
    \[ FMI = \sqrt{\frac{a}{a+b} \cdot \frac{a}{a+c}} \]
  - **RI指数** (Rand Index):
    \[ RI = \frac{2(a+d)}{m(m-1)} \]

这些指标本质上都是衡量两套划分在**同簇**和**不同簇**判断上的一致程度。

### 3.2 内部指标 (Internal Index)
> **无需任何参考，直接考察聚类结果本身**

其核心是量化 **“簇内相似度高，簇间相似度低”** 的程度。

**核心直觉**：一个好的聚类，应该满足：
- **物以类聚**：簇内样本的平均距离小，即 \( avg(C) \) 小。
- **人以群分**：簇间样本的平均距离大，即 \( d_{\text{cen}}(C_i, C_j) \) 大。

基于此直觉，可以设计**聚落度** (Compactness) 和**分离度** (Separation) 的比值（或差值）作为评价函数。这通常是实际应用中的主要评价方式。

---

## 4. 总结

- **聚类**是无监督学习中最核心的任务之一，旨在发现数据固有的分布结构。
- 其有效性严重依赖于**距离度量的定义**，而距离定义又依赖于对**属性类型**的深刻理解。
- 评价聚类质量时，若有“真实标签”，可使用**外部指标**进行量化对比；若无，则必须依赖**内部指标**，其核心是**簇内紧致、簇间分离**的直觉。

因此，一个成功的聚类分析，始于对数据的深入理解，成于对评价指标的合理选择。
