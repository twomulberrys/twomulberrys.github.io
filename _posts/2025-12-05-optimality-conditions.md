---
title: 第七章：最优性条件 (KKT)
date: 2025-12-05 20:00:00 +0800
categories: [学习笔记, 最优化]
tags: [数学, KKT条件, 非线性规划, 期末复习]
math: true
---

整理了最优化理论第七章的核心内容。本章聚焦于无约束和约束问题的极值条件，其中 **KKT 条件 (Karush-Kuhn-Tucker Conditions)** 是解决非线性规划问题的核心工具，也是期末考试的必考点。

## 1. 无约束问题的极值条件

考虑问题 $\min f(x), x \in \mathbb{R}^n$。

### 1.1 必要与充分条件
> **定理 1.1 (一阶必要条件)**
> 若 $x^*$ 是局部极小点，且 $f$ 可微，则梯度为零：
> $$\nabla f(x^*) = 0$$

> **定理 1.2 (二阶必要与充分条件)**
> 设 $f$ 二阶连续可微。
> * **必要条件**：若 $x^*$ 是局部极小点，则 $\nabla f(x^*) = 0$ 且 Hesse 矩阵 $\nabla^2 f(x^*)$ **半正定**。
> * **充分条件**：若 $\nabla f(x^*) = 0$ 且 $\nabla^2 f(x^*)$ **正定**，则 $x^*$ 是严格局部极小点。

---

## 2. 约束问题的最优性条件 (KKT)

考虑非线性规划问题：
$$
\begin{aligned}
\min \quad & f(x) \\
\text{s.t.} \quad & g_i(x) \ge 0, \quad i=1,\dots,m \\
& h_j(x) = 0, \quad j=1,\dots,l
\end{aligned}
$$

### 2.1 拉格朗日函数
$$L(x, w, v) = f(x) - \sum_{i=1}^m w_i g_i(x) - \sum_{j=1}^l v_j h_j(x)$$
*(注：为保证 $w_i \ge 0$，通常采用减去不等式约束项的形式)*

### 2.2 KKT 条件 (一阶必要条件)
设 $x^*$ 是局部极小点，且满足约束规范条件 (LICQ)，则存在乘子 $w^*, v^*$ 满足以下 4 组条件：

> **1. 平稳性 (Stationarity)**
> 拉格朗日函数的梯度为 0：
> $$\nabla f(x^*) - \sum_{i=1}^m w_i^* \nabla g_i(x^*) - \sum_{j=1}^l v_j^* \nabla h_j(x^*) = 0$$
>
> **2. 原问题可行性 (Primal Feasibility)**
> $$g_i(x^*) \ge 0, \quad h_j(x^*) = 0$$
>
> **3. 对偶可行性 (Dual Feasibility)**
> $$w_i^* \ge 0 \quad (\text{不等式约束乘子非负})$$
>
> **4. 互补松弛条件 (Complementary Slackness)**
> $$w_i^* g_i(x^*) = 0, \quad i=1,\dots,m$$

**解题核心**：互补松弛条件意味着**要么约束取等号 ($g_i=0$)，要么乘子为 0 ($w_i=0$)**。这是解题时进行**分类讨论**的基础。

---

## 3. 充分条件

> **定理 1.4 (凸规划充分性)**
> 设 $f$ 是凸函数，$g_i$ 是凹函数，$h_j$ 是线性函数。若存在 $x^*$ 及乘子 $w, v$ 满足 KKT 条件，则 $x^*$ 是问题的**全局极小点**。

---

## 4. 重点习题详解

### 习题 1：KKT 条件的应用 (典型考题)
**题目**：求解下列非线性规划问题：
$$\min f(x) = (x_1 - 1)^2 + x_2 - 2$$
$$\text{s.t.} \quad g_1(x) = x_2 - x_1 - 1 \ge 0$$
$$\quad \quad g_2(x) = 2 - x_1 - x_2 \ge 0$$
*(注：原题 $g_2$ 为 $\le 0$，此处已化为标准型 $\ge 0$)*

**解**：
1.  **构造拉格朗日函数**：
    $$L = (x_1 - 1)^2 + x_2 - 2 - w_1(x_2 - x_1 - 1) - w_2(2 - x_1 - x_2)$$
2.  **列出 KKT 平稳性方程**：
    $$\begin{cases} 2(x_1 - 1) + w_1 + w_2 = 0 \\ 1 - w_1 + w_2 = 0 \end{cases}$$
3.  **利用互补松弛条件分类讨论**：
    * **情形 1 ($w_1=0, w_2=0$)**：
        由方程得 $2(x_1-1)=0 \Rightarrow x_1=1$；$1=0$ (矛盾)。无解。
    * **情形 2 ($w_1>0, w_2=0$)**：
        $g_1$ 起作用 ($x_2 - x_1 = 1$)。由梯度方程 $1 - w_1 = 0 \Rightarrow w_1 = 1 > 0$ (合法)。
        代入得 $2(x_1 - 1) + 1 = 0 \Rightarrow x_1 = 0.5$。进而 $x_2 = 1.5$。
        检验 $g_2$：$2 - 0.5 - 1.5 = 0$，说明 $g_2$ 也起作用了（实际上是退化情况）。
    * **情形 3 ($w_1=0, w_2>0$)**：
        由梯度方程 $1 + w_2 = 0 \Rightarrow w_2 = -1 < 0$。违反非负性，舍去。
    * **情形 4 ($w_1>0, w_2>0$)**：
        两个约束都取等号。解方程组 $\begin{cases} x_2 - x_1 = 1 \\ x_1 + x_2 = 2 \end{cases}$ 得 $x = (0.5, 1.5)$。
        代入梯度方程解得 $w_1 = 1, w_2 = 0$。

**结论**：唯一 KKT 点为 $x^* = (0.5, 1.5)$。由于目标函数凸，约束为线性（凸集），故为全局最优解。

<br>

### 习题 2：凸规划充分性证明
**题目**：证明对于凸规划问题 $\min \{f(x) \mid g_i(x) \ge 0\}$，若 $x^*$ 满足 KKT 条件，则 $x^*$ 必为全局最优解。

**解**：
设 $(x^*, w^*)$ 满足 KKT 条件。对于任意可行解 $x$ (即 $g_i(x) \ge 0$)：
1.  由于 $f$ 是凸函数：
    $$f(x) \ge f(x^*) + \nabla f(x^*)^T(x - x^*)$$
2.  由 KKT 平稳性条件 $\nabla f(x^*) = \sum w_i^* \nabla g_i(x^*)$，代入得：
    $$f(x) \ge f(x^*) + \sum w_i^* \nabla g_i(x^*)^T(x - x^*)$$
3.  由于 $g_i$ 是凹函数，$-g_i$ 是凸函数，利用凸性性质可推导：
    $$\nabla g_i(x^*)^T(x - x^*) \ge g_i(x^*) - g_i(x)$$
4.  结合 $w_i^* \ge 0$ 和互补松弛 $w_i^* g_i(x^*) = 0$，以及可行性 $g_i(x) \ge 0$，最终可证得右端项 $\ge 0$。
    故 $f(x) \ge f(x^*)$。得证。
