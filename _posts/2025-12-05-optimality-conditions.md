---
title: "第七章：最优性条件与KKT理论"
date: 2025-12-05 20:00:00 +0800
categories: [学习笔记, 最优化]
tags: [数学, KKT条件, 拉格朗日对偶, 期末复习]
math: true
---

整理了最优化理论第七章的核心内容。本章聚焦于无约束和约束问题的极值条件，其中 **KKT 条件 (Karush-Kuhn-Tucker Conditions)** 是解决非线性规划问题的核心工具，也是期末考试的重中之重。

## 1. 无约束问题的极值条件

考虑问题 $\min f(x), x \in \mathbb{R}^n$。

### 1.1 必要与充分条件
> **定理 1.1 (一阶必要条件)**
> 若 $x^*$ 是局部极小点，且 $f$ 可微，则梯度为零：
> $$\nabla f(x^*) = 0$$

> **定理 1.2 (二阶必要与充分条件)**
> 设 $f$ 二阶连续可微。
> * **必要条件**：若 $x^*$ 是局部极小点，则 $\nabla f(x^*) = 0$ 且 Hesse 矩阵 $\nabla^2 f(x^*)$ **半正定**。
> * **充分条件**：若 $\nabla f(x^*) = 0$ 且 $\nabla^2 f(x^*)$ **正定**，则 $x^*$ 是严格局部极小点。

### 1.2 下降方向与可行方向
* **下降方向**：若 $\nabla f(x)^T d < 0$，则 $d$ 必为 $f(x)$ 在 $x$ 处的下降方向。
* **可行方向**：设 $x \in \text{cl } S$，若存在 $\delta > 0$，使得对任意 $\lambda \in (0, \delta)$ 都有 $x + \lambda d \in S$，则称 $d$ 为可行方向。

---

## 2. 约束问题的最优性条件 (KKT)

考虑非线性规划问题：
$$
\begin{aligned}
\min \quad & f(x) \\
\text{s.t.} \quad & g_i(x) \ge 0, \quad i=1,\dots,m \\
& h_j(x) = 0, \quad j=1,\dots,l
\end{aligned}
$$

### 2.1 拉格朗日函数
$$L(x, w, v) = f(x) - \sum_{i=1}^m w_i g_i(x) - \sum_{j=1}^l v_j h_j(x)$$
*(注：为保证 $w_i \ge 0$，通常采用减去不等式约束项的形式)*

### 2.2 KKT 条件 (一阶必要条件)
设 $x^*$ 是局部极小点，且满足约束规范条件 (LICQ)，则存在乘子 $w^*, v^*$ 满足以下 4 组条件：

> **1. 平稳性 (Stationarity)**
> 拉格朗日函数的梯度为 0：
> $$\nabla f(x^*) - \sum_{i=1}^m w_i^* \nabla g_i(x^*) - \sum_{j=1}^l v_j^* \nabla h_j(x^*) = 0$$
>
> **2. 原问题可行性 (Primal Feasibility)**
> $$g_i(x^*) \ge 0, \quad h_j(x^*) = 0$$
>
> **3. 对偶可行性 (Dual Feasibility)**
> $$w_i^* \ge 0 \quad (\text{不等式约束乘子非负})$$
>
> **4. 互补松弛条件 (Complementary Slackness)**
> $$w_i^* g_i(x^*) = 0, \quad i=1,\dots,m$$
>
> **含义**：要么约束取等号 ($g_i=0$)，要么乘子为 0 ($w_i=0$)。这是解题时**分类讨论**的基础。

---

## 3. 充分条件与二阶条件

> **定理 1.4 (凸规划充分性)**
> 设 $f$ 是凸函数，$g_i$ 是凹函数，$h_j$ 是线性函数。若存在 $x^*$ 及乘子 $w, v$ 满足 KKT 条件，则 $x^*$ 是问题的**全局极小点**。

> **定理 1.6 (二阶充分条件)**
> 设 $x^*$ 满足 KKT 条件，若对于任意严格互补下的切空间内的非零向量 $d$，都有：
> $$d^T \nabla_{xx}^2 L(x^*, w, v) d > 0$$
> 即拉格朗日函数的 Hesse 矩阵在子空间上正定，则 $x^*$ 是严格局部极小点。

---

## 4. 重点习题详解

### 习题 1：KKT 条件的应用 (例 2.1)
**题目**：求解下列非线性规划问题：
$$\min f(x) = (x_1 - 1)^2 + x_2 - 2$$
$$\text{s.t.} \quad g_1(x) = x_2 - x_1 - 1 \ge 0$$
$$\quad \quad g_2(x) = 2 - x_1 - x_2 \ge 0$$
*(注：原题 $g_2$ 为 $\le 0$，此处已化为标准型 $\ge 0$)*

**解**：
1.  **构造拉格朗日函数**：
    $$L = (x_1 - 1)^2 + x_2 - 2 - w_1(x_2 - x_1 - 1) - w_2(2 - x_1 - x_2)$$
2.  **列出 KKT 平稳性方程**：
    $$\begin{cases} 2(x_1 - 1) + w_1 + w_2 = 0 \\ 1 - w_1 + w_2 = 0 \end{cases}$$
3.  **利用互补松弛条件分类讨论**：
    * **情形 1 ($w_1=0, w_2=0$)**：
        由方程得 $2(x_1-1)=0 \Rightarrow x_1=1$；$1=0$ (矛盾)。无解。
    * **情形 2 ($w_1>0, w_2=0$)**：
        $g_1$ 起作用 ($x_2 - x_1 = 1$)。由梯度方程 $1 - w_1 = 0 \Rightarrow w_1 = 1 > 0$ (合法)。
        代入得 $2(x_1 - 1) + 1 = 0 \Rightarrow x_1 = 0.5$。进而 $x_2 = 1.5$。
        检验 $g_2$：$2 - 0.5 - 1.5 = 0$，说明 $g_2$ 也起作用了。
    * **情形 3 ($w_1>0, w_2>0$)**：
        两个约束都取等号。解方程组 $\begin{cases} x_2 - x_1 = 1 \\ x_1 + x_2 = 2 \end{cases}$ 得 $x = (0.5, 1.5)$。
        代入梯度方程求乘子：解得 $w_1 = 1, w_2 = 0$。满足 $w \ge 0$。

**结论**：唯一 KKT 点为 $x^* = (0.5, 1.5)$。由于目标函数凸，约束为线性（凸集），故为全局最优解。

<br>

### 习题 2：二次规划 (例 2.2)
**题目**：求解 $\min x_1^2 + x_2^2 - 4x_1 - 4x_2$，s.t. $x_1 + x_2 \le 2, \quad x_1, x_2 \ge 0$。

**解**：
* **几何直观**：目标函数是圆心在 $(2, 2)$ 的同心圆，可行域是原点附近的三角形。显然圆心在可行域外，最优解应在边界 $x_1 + x_2 = 2$ 上切点处。
* **KKT 求解**：
    猜测有效约束为 $x_1 + x_2 = 2$ 且 $x_1, x_2 > 0$ (即 $w_1 > 0, w_2=0, w_3=0$)。
    梯度条件：
    $$\begin{pmatrix} 2x_1 - 4 \\ 2x_2 - 4 \end{pmatrix} - w_1 \begin{pmatrix} -1 \\ -1 \end{pmatrix} = 0 \implies \begin{cases} 2x_1 - 4 + w_1 = 0 \\ 2x_2 - 4 + w_1 = 0 \end{cases}$$
    结合 $x_1 + x_2 = 2$，解得 $x_1 = 1, x_2 = 1$。
    求出乘子 $w_1 = 4 - 2(1) = 2 > 0$。满足所有 KKT 条件。

**结论**：$x^* = (1, 1)$ 是最优解。

<br>

### 习题 3：凸规划充分性证明 (例 2.4)
**题目**：证明对于凸规划问题 $\min \{f(x) \mid g_i(x) \ge 0\}$，若 $x^*$ 满足 KKT 条件，则 $x^*$ 必为全局最优解。

**解**：
设 $(x^*, w^*)$ 满足 KKT 条件。对于任意可行解 $x$ (即 $g_i(x) \ge 0$)：
由于 $f$ 是凸函数：
$$f(x) \ge f(x^*) + \nabla f(x^*)^T(x - x^*)$$
由 KKT 平稳性条件 $\nabla f(x^*) = \sum w_i^* \nabla g_i(x^*)$，代入得：
$$f(x) \ge f(x^*) + \sum_{i=1}^m w_i^* \nabla g_i(x^*)^T(x - x^*)$$
由于 $g_i$ 是凹函数（定义凸集），故 $-g_i$ 是凸函数，即：
$$-g_i(x) \ge -g_i(x^*) - \nabla g_i(x^*)^T(x - x^*)$$
移项得 $\nabla g_i(x^*)^T(x - x^*) \ge g_i(x^*) - g_i(x)$。代回原式求和项：
$$\sum w_i^* [g_i(x^*) - g_i(x)]$$
利用 KKT 条件：$w_i^* \ge 0$，且互补松弛 $w_i^* g_i(x^*) = 0$。
因为 $x$ 可行 ($g_i(x) \ge 0$)，所以 $-w_i^* g_i(x) \le 0$。
此处符号需仔细整理：
$\nabla g_i(x^*)^T(x - x^*) \ge -g_i(x)$ (因为 $g_i(x^*) \approx 0$ or $w_i^*=0$)
最终推导出 $\sum w_i^* \nabla g_i(x^*)^T(x - x^*) \ge 0$。
故 $f(x) \ge f(x^*)$。得证。
