---
title: "第四章：对偶理论与灵敏度分析"
date: 2025-12-05 16:00:00 +0800
categories: [学习笔记, 最优化]
tags: [数学, 线性规划, 对偶理论, 灵敏度分析, 期末复习]
math: true
---

整理了最优化理论第四章的核心内容。本章是线性规划的进阶部分，重点掌握原问题与对偶问题的变换、利用互补松弛定理求解对偶解、对偶单纯形法的算法流程，以及利用最优单纯形表进行灵敏度分析的方法。

## 1. 对偶理论 (Duality Theory)

### 1.1 对偶问题的定义与变换
对于一般的线性规划问题，原问题 (P) 与对偶问题 (D) 的对应关系如下表（记忆口诀：**对偶变量看约束，对偶约束看变量**）：

| 原问题 (Min) | 对应关系 | 对偶问题 (Max) |
| :--- | :---: | :--- |
| **变量** $x_j$ | $\longleftrightarrow$ | **第 $j$ 个约束** |
| $x_j \ge 0$ | | $\le$ |
| $x_j \le 0$ | | $\ge$ |
| $x_j$ 无限制 | | $=$ |
| **第 $i$ 个约束** | $\longleftrightarrow$ | **变量** $y_i$ |
| $\ge b_i$ | | $y_i \ge 0$ |
| $\le b_i$ | | $y_i \le 0$ |
| $= b_i$ | | $y_i$ 无限制 |

### 1.2 对偶基本定理

> **定理 1.1 (弱对偶定理)**
> 设 $x$ 是原问题 (min) 的可行解，$y$ 是对偶问题 (max) 的可行解，则 $cx \ge yb$。

> **定理 1.2 (强对偶定理)**
> 若原问题有最优解 $x^*$，则对偶问题必有最优解 $y^*$，且目标函数值相等：$z^* = cx^* = y^*b = w^*$。

> **定理 1.3 (互补松弛定理)**
> $x^*$ 和 $y^*$ 分别是原问题和对偶问题的最优解的充要条件是：
> $$y^{*T}(Ax^* - b) = 0 \quad \text{且} \quad (y^*A - c)x^* = 0$$
>
> **解题应用策略**：
> 1. 若原问题第 $i$ 个约束**松弛**（取严格不等号） $\Rightarrow$ 对应对偶变量 $y_i^* = 0$。
> 2. 若原问题某个变量 $x_j^* > 0$ $\Rightarrow$ 对应对偶约束**取等号**（紧约束）。
> 3. 反之亦然。常用于“已知原问题一个解，求对偶最优解”的题目。

---

## 2. 对偶单纯形法 (Dual Simplex Method)

### 2.1 核心思想
* **原单纯形法**：保持可行性 ($b \ge 0$)，迭代追求最优性 ($\sigma \le 0$)。
* **对偶单纯形法**：保持最优性 ($\sigma \le 0$)，迭代追求可行性 ($b \ge 0$)。

**适用场景**：
1.  初始表中检验数已满足条件 ($\sigma \le 0$)，但右端项有负数。
2.  **灵敏度分析**中，当右端项 $b$ 变化或增加新约束导致解不可行时。

### 2.2 算法步骤 (以 Min 问题为例)
前置条件：单纯形表中所有检验数 $\sigma_j \le 0$（即对偶可行）。

1.  **确定离基变量**：选出右端项中最小的负数（绝对值最大的负数）：
    $$r = \text{argmin}_i \{ b_i \mid b_i < 0 \}$$
    对应的基变量 $x_{B_r}$ 离基。
2.  **确定入基变量**：在主行中，检查系数 $y_{rj}$。若所有 $y_{rj} \ge 0$，则无解。否则，计算比值，选择最小者：
    $$\theta = \min \left\{ \frac{\sigma_j}{y_{rj}} \mid y_{rj} < 0 \right\}$$
    对应的 $x_k$ 进基。
3.  **旋转运算**：以 $y_{rk}$ 为主元进行高斯消元。

---

## 3. 灵敏度分析 (Sensitivity Analysis)

利用最优单纯形表中的数据 ($B^{-1}, w, b$) 分析参数变化，无需重新计算。

### 3.1 改变右端向量 $b$
设 $b$ 变为 $b' = b + \Delta b$。
* **影响**：只影响基变量的取值（可行性），不影响检验数（最优性）。
* **计算**：新基变量值 $x_B' = B^{-1}b'$。
* **对策**：
    1.  若 $x_B' \ge 0$，最优基不变，更新最优解即可。
    2.  若 $x_B'$ 存在负分量，原基不再可行。使用**对偶单纯形法**恢复可行性。

### 3.2 改变价值系数 $c$
* **情形 A：改变非基变量 $c_j$**
    * 仅影响该变量的检验数 $\sigma_j' = w p_j - c_j'$。
    * 若 $\sigma_j' > 0$，该变量入基，用**原单纯形法**迭代。
* **情形 B：改变基变量 $c_k$**
    * 影响单纯形乘子 $w$，导致所有非基变量检验数变化。
    * 需重新计算 $\sigma$，若存在 $>0$，用**原单纯形法**迭代。

### 3.3 增加新约束
设增加约束 $a_{m+1}x \le b_{m+1}$。
1.  **检验**：将原最优解 $x^*$ 代入新约束。若满足，则最优解不变。
2.  **处理**：若不满足，引入松弛变量，将新约束化为等式加入单纯形表。
3.  **迭代**：利用行变换将基变量系数化为 0，此时通常新行的右端项为负。使用**对偶单纯形法**求解。

### 3.4 增加新变量
设增加变量 $x_{new}$，系数 $P_{new}$，成本 $c_{new}$。
1.  **计算检验数**：$\sigma_{new} = w P_{new} - c_{new}$。
2.  **判断**：
    * 若 $\sigma_{new} \le 0$，原解仍最优。
    * 若 $\sigma_{new} > 0$，将 $P_{new}$ 转换到当前基下 ($y_{new} = B^{-1}P_{new}$) 加入表中，作为入基变量用**原单纯形法**迭代。

---

## 4. 重点习题详解

### 习题 1：互补松弛定理应用 (例 4.3)
**题目**：已知原问题及对偶问题的最优解为 $(w_1, w_2) = (5/3, 7/3)$，利用对偶性质求原问题最优解。
原问题：$\min 4x_1 + 3x_2 + x_3$，s.t. $x_1 - x_2 + x_3 \ge 1$, $x_1 + 2x_2 - 3x_3 \ge 2$, $x \ge 0$。

**解**：
1.  **检查对偶约束松弛情况**：
    * 第 1 个对偶约束：$w_1 + w_2 = 5/3 + 7/3 = 4$（取等号）$\Rightarrow x_1$ 可能 $>0$。
    * 第 2 个对偶约束：$-w_1 + 2w_2 = -5/3 + 14/3 = 3$（取等号）$\Rightarrow x_2$ 可能 $>0$。
    * 第 3 个对偶约束：$w_1 - 3w_2 = 5/3 - 7 = -16/3 < 1$（严格不等）$\Rightarrow x_3 = 0$。
2.  **求解方程组**：
    代入 $x_3 = 0$ 到原问题取等号的约束（因为 $w_1, w_2 > 0$，原问题两个约束均为紧约束）：
    $$\begin{cases} x_1 - x_2 = 1 \\ x_1 + 2x_2 = 2 \end{cases} \Rightarrow 3x_2 = 1 \Rightarrow x_2 = 1/3, x_1 = 4/3$$
**结论**：原问题最优解为 $x^* = (4/3, 1/3, 0)^T$。

### 习题 2：增加新约束 (例 3.1)
**题目**：已知问题 $\min x_1 + x_2 - 4x_3$，最优解 $x^* = (1/3, 0, 13/3)^T$。现增加新约束 $-3x_1 + x_2 + 6x_3 \le 17$。

**解**：
1.  **检验可行性**：代入 $x^*$：
    $$-3(1/3) + 0 + 6(13/3) = -1 + 26 = 25 \not\le 17$$
    原解不可行。
2.  **添加约束**：引入松弛变量 $x_7$，约束变为 $-3x_1 + x_2 + 6x_3 + x_7 = 17$。
3.  **消去基变量**：假设基变量为 $x_1, x_3$。需将新行中 $x_1, x_3$ 的系数化为 0。
    变换后新行的右端项：$17 - 25 = -8$。
    新行方程：$\dots + x_7 = -8$。
4.  **对偶单纯形迭代**：因为 $b_7 = -8 < 0$，选 $x_7$ 离基。计算比值确定入基变量。
**结果**：迭代后得到新最优解，目标函数值变差（因为可行域变小了）。
